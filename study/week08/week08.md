## 연관관계 정의 규칙

- 방향
    - 단방향 연관관계
    - 양방향 연관관계
- 연관관계 주인
    - 양방향 연관관계 시, 연관관계에서의 관리 주체
- 다중성
    - 다대일, 일대다, 일대일, 다대다

## 방향

- 단방향 연관관계
    - 참조용 필드를 한 쪽만 가지고 있는 구조
- 양방향 연관관계
    - 참조용 필드를 양 쪽 모두 가지고 있는 구조
    - 연관관계 주인을 지정해야 함

## 연관 관계 주인

- 엔티티를 양방향 연관관계로 설정하면 객체의 참조는 두개지만 외래키는 하나가 됨
    - 테이블의 외래키를 관리할 연관관계의 주인을 지정해야함

| 주인 | 주인이 아닌 쪽 |
| --- | --- |
| 외래키 관리 기능 | 읽기만 가능 |
| mappedBy을 사용x | mappedBy 속성 사용 |
| 테이블에 외래키가 있는 곳이 주인이 됨 |  |
| 1:N,N:1 관계에선 N쪽이 외래키를 가짐 |  |

## 다중성

- 다대일(N:1)
    - ManyToOne
    - 여러개가 하나를 참조
    - 여러 멤버가 하나의 팀에 속함
- 일대다(1:N)
    - 하나가 여러개를 참조
    - OneToMany
    - 하나의 팀에 여러 멤버가 속함
- 일대일(1:1)
    - OneToOne
    - 하나가 다른 하나와만 연결
    - 한 사람 당 하나의 여권, 하나의 여권은 한 명에게만 속함
- 다대다(N:M)
    - ManyToMany
    - 여러개가 여러개를 참조
    - 한 게시글엔 여러 태그 등록 가능/하나의 태그에는 여러개의 게시글이 포함됨
    - RDB 에서는 2개의 테이블로 다대다 관계 표현이 불가능
        - 중간 테이블을 만들어 일대다-다대일 관계로 풀어야 함

## Fetch Type

- JPA에서 엔티티를 조회할 때 연관된 엔티티 조회 방법을 결정하는 전략
- 연관된 엔티티를 함께 조회할 것인지 필요에 따라 조회할 것인지 결정
- 즉시 로딩
    - 엔티티 조회 시 연관된 엔티티도 즉시 함께 조회
- 지연 로딩
    - 관련된 엔티티가 실제로 사용될 때 조

## ERD Cloud

- Identifying Relationship (식별관계)
    - 부모 테이블의 기본키를 자식테이블의 기본키로 사용하는 관계
- Non - Identifying Relationship (비식별관계)
    - 부모 테이블의 기본키를 자식테이블에서 외래키로 사용하는 관

## ERD 작성 시 주의 해야 할 제약 사항

- 데이터 무결성
    - 각 엔티티는 고유하게 식별될 수 있도록 기본키를 반드시 설정해야 함
    - 두 엔티티 간의 관계를 나타낼 때 외래키를 사용하여 관계를 설정해야 함
        - 외래키는 부모 테이블의 기본키와 동일한 도메인을 가져야 하며, 부모 테이블의 값이 변경될 때 자식 테이블에 영향을 미치지 않도록 제약을 설정해여 한다.
    - 각 컬럼에 NULL값이 허용될 지의 여부를 명확하게 정의
    - 각 컬럼의 데이터 타입을 명확하게 정의
- 관계의 정확성
    - 엔티티 간의 관계를 1:1, 1:N, N:1, N:N으로 정확하게 표현해야 함
    - 각 엔티티가 관계에 참여하는 정도를 명확하게 표현
    - 엔티티 간의 관계를 명확하게 나타낼 수 있도록 관계명을 확실하게 정의
- 데이터 중복방지
    - 중복된 튜플x
    - 중복된 컬럼x
- 데이터 유일성
    - 기본키는 유일해야 함
    - 필요 시, 특정 컬럼이 유일한 값을 가질 경우 UNIQUE 제약 설정
- 데이터의 일관성
    - DB에서 데이터 변경 작업을 수행할 때 트랜잭션을 사용하여 일관성 유지
    - 데이터의 일관성을 유지하기 위해 필요한 제약 사항을 설정