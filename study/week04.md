# Spring Boot (Week 4)

# π± Spring Data JPA λ° μ¤ν”„λ§ κµ¬μ„± μ”μ† κ°λ… μ •λ¦¬

---

## μμ΅΄μ„± - Spring Data JPA

- ν„λ€ μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤(RDB)λ” ν•„μ μ”μ†
- κ°μ²΄λ¥Ό RDBμ—μ„ κ΄€λ¦¬ν•λ” κ²ƒμ΄ λ§¤μ° μ¤‘μ”ν•¨
- ν•μ§€λ§ ν”„λ΅μ νΈκ°€ SQL μ„μ£Όλ΅ μ‘μ„±λλ©΄ μ½”λ“ ν’μ§ μ €ν• λ° μ μ§€λ³΄μ μ–΄λ ¤μ›€ λ°μƒ

---

## RDBμ™€ κ°μ²΄μ§€ν–¥μ ν¨λ¬λ‹¤μ„ μ¶©λ

- RDB: **λ°μ΄ν„° μ €μ¥ λ°©μ‹ μ¤‘μ‹¬** κΈ°μ 
- κ°μ²΄μ§€ν–¥ μ–Έμ–΄: **κΈ°λ¥κ³Ό μ†μ„± ν†µν•© μ¤‘μ‹¬** κΈ°μ 
- μ„λ΅ ν¨λ¬λ‹¤μ„μ΄ λ‹¬λΌ κ°μ²΄λ¥Ό RDBμ— μ €μ¥ν•λ ¤ ν•  λ• λ¶μΌμΉ λ¬Έμ  λ°μƒ

---

## JPAμ μ—­ν• 

- κ°λ°μλ” **κ°μ²΄μ§€ν–¥**μ μΌλ΅ ν”„λ΅κ·Έλλ°
- JPAλ” μ΄λ¥Ό RDBμ— λ§κ² **μλ™μΌλ΅ SQL μƒμ„± λ° μ‹¤ν–‰**
- β†’ **SQLμ— μΆ…μ†λμ§€ μ•λ” κ°λ°** κ°€λ¥

---

## Lombokμ μμ΅΄μ„±

- μλ°” ν΄λμ¤ μƒμ„± μ‹ λ°λ³µλλ” μ½”λ“ λ§μ β†’ μ‹¤μ, μ‘μ—…λ‰ μ¦κ°€
- λ€λ¶€λ¶„ **μλ―Έ μ—†λ” λ°λ³µ μ‘μ—…** (getter, setter, constructor λ“±)

---

## Lombok

- **μ–΄λ…Έν…μ΄μ… κΈ°λ° μ½”λ“ μλ™ μƒμ„± λΌμ΄λΈλ¬λ¦¬**
- μ£Όμ” μλ™ μƒμ„± λ©”μ„λ“:
    - μƒμ„±μ
    - `getName()`, `setAge()`, `toString()`, `equals()` λ“±
- β†’ **μ½”λ“ κ°„κ²°ν™”** λ° **μƒμ‚°μ„± ν–¥μƒ**

---

## μ¤ν”„λ§λ¶€νΈ κΈ°λ³Έ κµ¬μ΅°

```
Client(browser)
   β†“    β†‘
 Controller
   β†“    β†‘
  Service
   β†“    β†‘
Repository
   β†“    β†‘
 Entity β†” Database
```

- κ³„μΈµ κ°„ DTOλ¥Ό ν†µν•΄ λ°μ΄ν„° μ „λ‹¬
- Repositoryλ” DBμ™€ μ§μ ‘ μ—°κ²°λκ³  Entityλ¥Ό λ‹¤λ£Έ

---

## Domain

- κ²μ‹κΈ€, νμ›, λ“κΈ€, κ²°μ  λ“± **μ”κµ¬μ‚¬ν•­ νΉμ€ λ¬Έμ  μμ—­**
- μ¦‰ **μ„λΉ„μ¤μ ν•µμ‹¬ μ£Όμ μ΄μ λΉ„μ¦λ‹μ¤ μμ—­**

---

### Domain κµ¬μ„± μ”μ†

- **Entity**: Post, Comment, User λ“± DBμ™€ λ§¤ν•‘λλ” κ°μ²΄
- **Repository**: λ°μ΄ν„° μ €μ¥/μ΅°ν μ—­ν• 
- **Business Logic**: λ„λ©”μΈ κ΄€λ ¨ λ΅μ§ μ²λ¦¬

> λ„λ©”μΈμ€ λΉ„μ¦λ‹μ¤ μ¤‘μ‹¬μ μ½”λ“λ“¤μ΄ λ¨μ΄λ” κ³µκ°„

---

## Entity ν΄λμ¤

- μ‹¤μ  DBμ ν…μ΄λΈ”κ³Ό λ§¤ν•‘λλ” ν΄λμ¤
- λ°λ“μ‹ `@Entity` μ–΄λ…Έν…μ΄μ… ν•„μ”
- ν•΄λ‹Ή ν΄λμ¤μ μΈμ¤ν„΄μ¤κ°€ JPAμ— μν•΄ κ΄€λ¦¬λ¨

### β οΈ κΈ°λ³Έ ν‚¤ μ„¤μ •

- κΈ°λ³Έ ν‚¤ μ§€μ • μ‹ `@Id` μ–΄λ…Έν…μ΄μ… μ‚¬μ©
- **Primary Key / Foreign Key** κ°λ…μ€ ν•„μ ν•™μµ ν•­λ©

---

## BaseTimeEntity

- JPAμ—μ„ κ³µν†µμΌλ΅ μ‚¬μ©ν•λ” ν•„λ“μΈ μƒμ„± μ‹κ°„(`createdDate`)κ³Ό μμ • μ‹κ°„(`modifiedDate`)μ„ μλ™ κ΄€λ¦¬ν•λ” **μ¶”μƒ ν΄λμ¤**
- μ—¬λ¬ μ—”ν‹°ν‹°μ—μ„ μƒμ†λ°›μ•„ λ°λ³µ μ κ±°

---

# π§© Spring Annotation & Swagger μ •λ¦¬

---

## ν΄λμ¤ λ λ²¨ μ–΄λ…Έν…μ΄μ… (κ³µν†µ)

- `@MappedSuperclass`  
  μƒμ†λ°›λ” μ—”ν‹°ν‹° ν΄λμ¤μ—μ„ ν•„λ“κ°€ ν…μ΄λΈ” μ»¬λΌμΌλ΅ μΈμ‹λκ² ν•¨

- `@EntityListeners(AuditingEntityListener.class)`  
  μƒμ„±/μμ • μ‹μ  μ½λ°±μ„ μ²λ¦¬ν•  μ μλ” λ¦¬μ¤λ„ λ“±λ΅

- `@CreatedDate`  
  μ²μ μ €μ¥λ  λ• μλ™μΌλ΅ ν„μ¬ μ‹κ°„ μ €μ¥

- `@LastModifiedDate`  
  μ—”ν‹°ν‹°κ°€ μ—…λ°μ΄νΈ λ  λ•λ§λ‹¤ ν„μ¬ μ‹κ°„ μλ™ μ„¤μ •

- β οΈ μ£Όμμ‚¬ν•­:  
  Main ν΄λμ¤μ— λ°λ“μ‹ `@EnableJpaAuditing` μ¶”κ°€ ν•„μ”

---

## ν΄λμ¤ λ λ²¨ μ–΄λ…Έν…μ΄μ… (JPA + Lombok)

- `@Entity`  
  μ΄ ν΄λμ¤κ°€ JPA μ—”ν‹°ν‹°μ„μ„ λ‚νƒ€λƒ„, DB ν…μ΄λΈ”κ³Ό λ§¤ν•‘λ¨

- `@Getter`  
  λ¨λ“  ν•„λ“μ getter μλ™ μƒμ„±

- `@Builder`  
  λΉλ” ν¨ν„΄ μ§€μ› (`Post.builder().title().content().build()`)

- `@NoArgsConstructor`  
  νλΌλ―Έν„° μ—†λ” κΈ°λ³Έ μƒμ„±μ μƒμ„± (JPAμ—μ„ ν•„μ)

- `@AllArgsConstructor`  
  λ¨λ“  ν•„λ“ κ°’μ„ μΈμλ΅ λ°›λ” μƒμ„±μ μλ™ μƒμ„±

- `@Table(name = "posts")`  
  DBμ— λ§¤ν•‘λ  ν…μ΄λΈ”λ…μ„ μ§€μ •

---

## ν•„λ“ λ λ²¨ μ–΄λ…Έν…μ΄μ…

- `@Id`  
  μ—”ν‹°ν‹°μ κΈ°λ³Έ ν‚¤ μ§€μ •

- `@GeneratedValue(strategy = GenerationType.IDENTITY)`  
  auto_increment λ°©μ‹μΌλ΅ κΈ°λ³Έ ν‚¤ μλ™ μƒμ„±

- `@Column(length = 500, nullable = false)`  
  μ»¬λΌ μ†μ„± μ§€μ • (κΈΈμ΄, null μ—¬λ¶€ λ“±)

---

## Controller

- μ‚¬μ©μμ μ”μ²­(Request)μ„ λ°›μ•„μ„ μ„λΉ„μ¤ λ΅μ§μ„ νΈμ¶ν•κ³ ,  
  κ²°κ³Όλ¥Ό μ‘λ‹µ(Response)μΌλ΅ λ°ν™ν•λ” μ—­ν• 

---

## Controller κ΄€λ ¨ μ–΄λ…Έν…μ΄μ…

- `@RequiredArgsConstructor`  
  ν•„μ”ν• ν•„λ“λ§ ν¬ν•¨ν• μƒμ„±μ μλ™ μƒμ„± (DIλ¥Ό μ„ν•¨)

- `@RestController`  
  REST API μ”μ²­μ„ μ²λ¦¬ν•λ” μ»¨νΈλ΅¤λ¬ μ§€μ •

- `@RequestMapping("/api/v1")`  
  ν•΄λ‹Ή ν΄λμ¤μ λ¨λ“  λ©”μ„λ“μ— κ³µν†µ URL prefix λ¶€μ—¬

---

## νλΌλ―Έν„° λ λ²¨ μ–΄λ…Έν…μ΄μ…

- `@RequestBody`  
  ν΄λΌμ΄μ–ΈνΈμ JSON μ”μ²­μ„ μλ°” κ°μ²΄λ΅ λ§¤ν•‘

- `@PathVariable`  
  URL κ²½λ΅ λ³€μ κ°’μ„ μλ°” λ³€μλ΅ μ¶”μ¶

---

## Swagger λ…μ„Έμ„ μ‘μ„± μ”λ Ή

### λ…μ„Έμ„ μ‘μ„± μ„μΉ
- **Controller**: API κΈ°λ¥ μ„¤λ…
- **DTO**: μ”μ²­/μ‘λ‹µ λ°μ΄ν„° κµ¬μ΅° μ„¤λ…

---

## Swagger μ–΄λ…Έν…μ΄μ…

- `@Tag`  
  API μΉ΄ν…κ³ λ¦¬ μ„¤λ…

- `@Operation`  
  ν•΄λ‹Ή API κΈ°λ¥μ— λ€ν• μ„¤λ…

- `@Parameter`  
  κ°λ³„ νλΌλ―Έν„°μ— λ€ν• μ„¤λ…

- `@Schema`  
  DTO ν•„λ“ μ„¤λ… + μμ‹κ°’(example) β†’ Swagger UIμ—μ„ μλ™ λ°μ

---